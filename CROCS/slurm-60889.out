crocs_original_charades
mvmr_test
2024-05-21 18:30:49,350 mmn INFO: Using 1 GPUs
2024-05-21 18:30:49,350 mmn INFO: DATALOADER:
  NUM_WORKERS: 16
DATASETS:
  FEATS_TYPE: original
  NAME: charades
  TEST: ('charades_test',)
  TRAIN: ('charades_train',)
INPUT:
  NUM_PRE_CLIPS: 32
MODEL:
  ARCHITECTURE: MMN
  DEVICE: cuda
  MMN:
    FEAT2D:
      NAME: pool
      POOLING_COUNTS: [15]
    FEATPOOL:
      HIDDEN_SIZE: 512
      INPUT_SIZE: 4096
      KERNEL_SIZE: 2
    JOINT_SPACE_SIZE: 256
    LOSS:
      BCE_WEIGHT: 1
      CONTRASTIVE_WEIGHT: 0.05
      MARGIN: 0.4
      MAX_IOU: 1.0
      MIN_IOU: 0.5
      NEGATIVE_VIDEO_IOU: 0.5
      NEGATIVE_WEIGHT: 0.3
      NUM_POSTIVE_VIDEO_PROPOSAL: 1
      PAIRWISE_SENT_WEIGHT: 0.0
      SENT_REMOVAL_IOU: 0.5
      TAU_SENT: 0.1
      TAU_VIDEO: 0.1
    NUM_CLIPS: 16
    PREDICTOR:
      HIDDEN_SIZE: 512
      KERNEL_SIZE: 5
      NUM_STACK_LAYERS: 8
    TEXT_ENCODER:
      INPUT_SIZE: 768
      NAME: BERT
MRC:
  BATCH_SIZE: 16
MVMR:
  NUM_SAMPLES: 50
OUTPUT_DIR: outputs/crocs_original_charades
PATHS_CATALOG: /home/yny/Lab/experiments/VL/Massive-Videos-Moment-Retrieval/CROCS/crocs/config/paths_catalog.py
SIMANS:
  BATCH_SIZE: 16
  POS_IOU_THRESH: 0.7
  PRE_TOPK: 100
  TAU: 0.5
  TOPK: 50
SOLVER:
  BATCH_SIZE: 48
  CHECKPOINT_PERIOD: 1
  FREEZE_BERT: 4
  FREEZE_CLIP: 4
  LR: 0.0001
  MAX_EPOCH: 50
  MILESTONES: (8, 13)
  ONLY_IOU: 14
  ONLY_POSITIVE: 7
  RESUME: False
  RESUME_EPOCH: 7
  SKIP_TEST: 0
  TEST_PERIOD: 1
TEST:
  BATCH_SIZE: 12
  CONTRASTIVE_SCORE_POW: 0.5
  NMS_THRESH: 0.5
/home/yny/.conda/envs/mvmr/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Some weights of the model checkpoint at distilbert-base-uncased were not used when initializing DistilBertModel: ['vocab_layer_norm.bias', 'vocab_projector.bias', 'vocab_layer_norm.weight', 'vocab_projector.weight', 'vocab_transform.bias', 'vocab_transform.weight']
- This IS expected if you are initializing DistilBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing DistilBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
dataset modified
2024-05-21 18:31:10,501 mmn.trainer INFO: Preparing data, please wait...
2024-05-21 18:31:12,371 mmn.inference INFO: Start evaluation on ('charades_test',) dataset (Size: 1334).
  0%|          | 0/112 [00:00<?, ?it/s]  1%|          | 1/112 [00:02<05:30,  2.97s/it]  2%|▏         | 2/112 [00:04<03:53,  2.12s/it]  3%|▎         | 3/112 [00:06<03:24,  1.88s/it]  4%|▎         | 4/112 [00:07<02:47,  1.55s/it]  4%|▍         | 5/112 [00:08<02:25,  1.36s/it]  5%|▌         | 6/112 [00:09<02:09,  1.22s/it]  6%|▋         | 7/112 [00:10<01:59,  1.14s/it]  7%|▋         | 8/112 [00:11<01:56,  1.12s/it]  8%|▊         | 9/112 [00:12<01:47,  1.05s/it]  9%|▉         | 10/112 [00:13<01:44,  1.02s/it] 10%|▉         | 11/112 [00:13<01:39,  1.02it/s] 11%|█         | 12/112 [00:15<01:42,  1.03s/it] 12%|█▏        | 13/112 [00:16<01:50,  1.12s/it] 12%|█▎        | 14/112 [00:17<01:56,  1.19s/it] 13%|█▎        | 15/112 [00:19<02:05,  1.29s/it] 14%|█▍        | 16/112 [00:20<01:55,  1.21s/it] 15%|█▌        | 17/112 [00:21<01:46,  1.13s/it] 16%|█▌        | 18/112 [00:22<01:42,  1.09s/it] 17%|█▋        | 19/112 [00:23<01:36,  1.04s/it] 18%|█▊        | 20/112 [00:24<01:34,  1.03s/it] 19%|█▉        | 21/112 [00:25<01:33,  1.03s/it] 20%|█▉        | 22/112 [00:26<01:31,  1.01s/it] 21%|██        | 23/112 [00:27<01:39,  1.12s/it] 21%|██▏       | 24/112 [00:30<02:20,  1.59s/it] 22%|██▏       | 25/112 [00:31<01:59,  1.38s/it] 23%|██▎       | 26/112 [00:31<01:46,  1.23s/it] 24%|██▍       | 27/112 [00:32<01:35,  1.13s/it] 25%|██▌       | 28/112 [00:33<01:32,  1.10s/it] 26%|██▌       | 29/112 [00:34<01:30,  1.09s/it] 27%|██▋       | 30/112 [00:35<01:24,  1.03s/it] 28%|██▊       | 31/112 [00:36<01:19,  1.01it/s] 29%|██▊       | 32/112 [00:37<01:18,  1.02it/s] 29%|██▉       | 33/112 [00:38<01:14,  1.05it/s] 30%|███       | 34/112 [00:39<01:11,  1.10it/s] 31%|███▏      | 35/112 [00:40<01:09,  1.10it/s] 32%|███▏      | 36/112 [00:48<03:46,  2.98s/it] 33%|███▎      | 37/112 [00:49<02:57,  2.37s/it] 34%|███▍      | 38/112 [00:50<02:29,  2.03s/it] 35%|███▍      | 39/112 [00:51<02:02,  1.68s/it] 36%|███▌      | 40/112 [00:51<01:41,  1.41s/it] 37%|███▋      | 41/112 [00:52<01:28,  1.24s/it] 38%|███▊      | 42/112 [00:53<01:18,  1.11s/it] 38%|███▊      | 43/112 [00:54<01:12,  1.04s/it] 39%|███▉      | 44/112 [00:55<01:05,  1.03it/s] 40%|████      | 45/112 [00:56<01:04,  1.04it/s] 41%|████      | 46/112 [00:57<01:02,  1.05it/s] 42%|████▏     | 47/112 [00:57<00:59,  1.10it/s] 43%|████▎     | 48/112 [00:59<01:04,  1.01s/it] 44%|████▍     | 49/112 [01:00<01:01,  1.03it/s] 45%|████▍     | 50/112 [01:01<01:02,  1.01s/it] 46%|████▌     | 51/112 [01:02<01:06,  1.09s/it] 46%|████▋     | 52/112 [01:03<01:02,  1.05s/it] 47%|████▋     | 53/112 [01:04<00:56,  1.04it/s] 48%|████▊     | 54/112 [01:05<00:54,  1.06it/s] 49%|████▉     | 55/112 [01:05<00:53,  1.07it/s] 50%|█████     | 56/112 [01:06<00:51,  1.08it/s] 51%|█████     | 57/112 [01:07<00:50,  1.10it/s] 52%|█████▏    | 58/112 [01:13<02:11,  2.44s/it] 53%|█████▎    | 59/112 [01:14<01:44,  1.98s/it] 54%|█████▎    | 60/112 [01:15<01:26,  1.66s/it] 54%|█████▍    | 61/112 [01:16<01:13,  1.44s/it] 55%|█████▌    | 62/112 [01:17<01:04,  1.28s/it] 56%|█████▋    | 63/112 [01:18<00:56,  1.15s/it] 57%|█████▋    | 64/112 [01:19<00:51,  1.08s/it] 58%|█████▊    | 65/112 [01:20<00:48,  1.03s/it] 59%|█████▉    | 66/112 [01:20<00:45,  1.00it/s] 60%|█████▉    | 67/112 [01:21<00:42,  1.05it/s] 61%|██████    | 68/112 [01:22<00:41,  1.07it/s] 62%|██████▏   | 69/112 [01:23<00:39,  1.10it/s] 62%|██████▎   | 70/112 [01:24<00:37,  1.13it/s] 63%|██████▎   | 71/112 [01:25<00:39,  1.04it/s] 64%|██████▍   | 72/112 [01:26<00:37,  1.07it/s] 65%|██████▌   | 73/112 [01:27<00:34,  1.13it/s] 66%|██████▌   | 74/112 [01:28<00:33,  1.12it/s] 67%|██████▋   | 75/112 [01:28<00:32,  1.13it/s] 68%|██████▊   | 76/112 [01:29<00:31,  1.13it/s] 69%|██████▉   | 77/112 [01:30<00:31,  1.11it/s] 70%|██████▉   | 78/112 [01:31<00:30,  1.11it/s] 71%|███████   | 79/112 [01:32<00:30,  1.09it/s] 71%|███████▏  | 80/112 [01:33<00:28,  1.12it/s] 72%|███████▏  | 81/112 [01:34<00:26,  1.15it/s] 73%|███████▎  | 82/112 [01:35<00:26,  1.14it/s] 74%|███████▍  | 83/112 [01:36<00:25,  1.16it/s] 75%|███████▌  | 84/112 [01:37<00:25,  1.11it/s] 76%|███████▌  | 85/112 [01:37<00:24,  1.12it/s] 77%|███████▋  | 86/112 [01:38<00:21,  1.19it/s] 78%|███████▊  | 87/112 [01:39<00:21,  1.18it/s] 79%|███████▊  | 88/112 [01:40<00:20,  1.17it/s] 79%|███████▉  | 89/112 [01:41<00:19,  1.19it/s] 80%|████████  | 90/112 [01:42<00:18,  1.19it/s] 81%|████████▏ | 91/112 [01:42<00:17,  1.18it/s] 82%|████████▏ | 92/112 [01:43<00:17,  1.15it/s] 83%|████████▎ | 93/112 [01:44<00:16,  1.14it/s] 84%|████████▍ | 94/112 [01:45<00:17,  1.01it/s] 85%|████████▍ | 95/112 [01:46<00:16,  1.06it/s] 86%|████████▌ | 96/112 [01:47<00:14,  1.10it/s] 87%|████████▋ | 97/112 [01:48<00:13,  1.08it/s] 88%|████████▊ | 98/112 [01:49<00:14,  1.01s/it] 88%|████████▊ | 99/112 [01:50<00:12,  1.08it/s] 89%|████████▉ | 100/112 [01:51<00:10,  1.12it/s] 90%|█████████ | 101/112 [01:52<00:09,  1.14it/s] 91%|█████████ | 102/112 [01:53<00:08,  1.14it/s] 92%|█████████▏| 103/112 [01:53<00:08,  1.12it/s] 93%|█████████▎| 104/112 [01:55<00:07,  1.03it/s] 94%|█████████▍| 105/112 [01:55<00:06,  1.06it/s] 95%|█████████▍| 106/112 [01:57<00:06,  1.06s/it] 96%|█████████▌| 107/112 [01:58<00:04,  1.00it/s] 96%|█████████▋| 108/112 [01:59<00:03,  1.03it/s] 97%|█████████▋| 109/112 [01:59<00:02,  1.11it/s] 98%|█████████▊| 110/112 [02:00<00:01,  1.14it/s] 99%|█████████▉| 111/112 [02:01<00:00,  1.17it/s]100%|██████████| 112/112 [02:01<00:00,  1.38it/s]100%|██████████| 112/112 [02:01<00:00,  1.09s/it]
2024-05-21 18:33:14.445374 MVMR 0 is over.
2024-05-21 18:33:58.156159 MVMR 500 is over.
2024-05-21 18:34:43.722783 MVMR 1000 is over.
2024-05-21 18:35:13,494 mmn.inference INFO: Model inference time: 0:00:19.629710 (0.015 s / inference per device, on 1 devices)
multiple positive evaluating mode.
2024-05-21 18:35:13,496 mmn.inference INFO: Performing CharadesDataset MVMR evaluation (Size: 1334).
[ 2024-05-21 18:35:13.498903 ] Evaluation 0 is over.
/home/yny/Lab/experiments/VL/Massive-Videos-Moment-Retrieval/CROCS/crocs/mvmr/evaluation.py:118: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mious = iou(tmp_preds[:r], torch.tensor(gt_moment).to(tmp_preds.device)).to(iou_metrics.device)
[ 2024-05-21 18:38:33.289176 ] Evaluation 500 is over.
[ 2024-05-21 18:42:00.372520 ] Evaluation 1000 is over.
2024-05-21 18:44:15,784 mmn.inference INFO: 
+-------------+-------------+-------------+-------------+-------------+-------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+
| R@1,IoU@0.3 | R@1,IoU@0.5 | R@1,IoU@0.7 | R@5,IoU@0.3 | R@5,IoU@0.5 | R@5,IoU@0.7 | R@10,IoU@0.3 | R@10,IoU@0.5 | R@10,IoU@0.7 | R@15,IoU@0.3 | R@15,IoU@0.5 | R@15,IoU@0.7 | R@20,IoU@0.3 | R@20,IoU@0.5 | R@20,IoU@0.7 | R@25,IoU@0.3 | R@25,IoU@0.5 | R@25,IoU@0.7 | R@30,IoU@0.3 | R@30,IoU@0.5 | R@30,IoU@0.7 | R@35,IoU@0.3 | R@35,IoU@0.5 | R@35,IoU@0.7 | R@40,IoU@0.3 | R@40,IoU@0.5 | R@40,IoU@0.7 | R@45,IoU@0.3 | R@45,IoU@0.5 | R@45,IoU@0.7 | R@50,IoU@0.3 | R@50,IoU@0.5 | R@50,IoU@0.7 |
+-------------+-------------+-------------+-------------+-------------+-------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+
|    21.80    |    18.60    |    12.27    |    47.77    |    42.47    |    28.85    |    59.69     |    52.61     |    37.70     |    66.77     |    59.10     |    43.78     |    70.91     |    63.72     |    48.44     |    74.54     |    67.47     |    51.96     |    77.31     |    70.29     |    54.98     |    79.39     |    72.39     |    57.27     |    81.40     |    74.70     |    59.45     |    82.91     |    76.35     |    61.41     |    84.50     |    77.80     |    62.97     |
+-------------+-------------+-------------+-------------+-------------+-------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+
************************
Job 60889 ended!
